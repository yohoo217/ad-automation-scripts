{% extends "base.html" %}

{% block title %}SuprAd è‡ªå‹•æˆªåœ–{% endblock %}

{% block page_title %}SuprAd è‡ªå‹•æˆªåœ–å·¥å…·{% endblock %}

{% block additional_styles %}
<style>
    .screenshot-form {
        max-width: 600px;
        margin: 0 auto;
        padding: 20px;
        border: 1px solid #ddd;
        border-radius: 8px;
        background-color: #f9f9f9;
    }
    
    .uuid-input {
        width: 100%;
        padding: 12px;
        border: 2px solid #ddd;
        border-radius: 6px;
        font-size: 16px;
        margin-bottom: 15px;
        box-sizing: border-box;
    }
    
    .uuid-input:focus {
        border-color: #5cb85c;
        outline: none;
    }
    
    .screenshot-btn {
        background-color: #5cb85c;
        color: white;
        padding: 12px 24px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 16px;
        width: 100%;
        margin-bottom: 15px;
    }
    
    .screenshot-btn:hover {
        background-color: #4cae4c;
    }
    
    .help-section {
        background-color: #fff;
        border: 1px solid #e0e0e0;
        border-radius: 6px;
        padding: 15px;
        margin-top: 20px;
    }
    
    .help-section h3 {
        color: #333;
        margin-top: 0;
    }
    
    .help-section ul {
        margin: 10px 0;
        padding-left: 20px;
    }
    
    .help-section li {
        margin: 5px 0;
        color: #666;
    }
    
    .screenshot-preview {
        max-width: 100%;
        border: 1px solid #ddd;
        border-radius: 6px;
        margin-top: 15px;
        display: block;
        margin-left: auto;
        margin-right: auto;
    }
    
    .preview-container {
        text-align: center;
        margin-top: 20px;
        padding: 15px;
        background-color: #fff;
        border: 1px solid #e0e0e0;
        border-radius: 6px;
    }
    
    .file-path {
        background-color: #f5f5f5;
        padding: 8px;
        border-radius: 4px;
        font-family: monospace;
        word-break: break-all;
        margin: 10px 0;
        border: 1px solid #ddd;
    }
    
    .info-box {
        background-color: #e7f3ff;
        border: 1px solid #b3d9ff;
        border-radius: 6px;
        padding: 12px;
        margin-bottom: 20px;
    }
    
    .info-box .icon {
        color: #0066cc;
        font-weight: bold;
        margin-right: 5px;
    }

    .adunit-info {
        background-color: #f0f8f0;
        border: 1px solid #c6e8c6;
        border-radius: 6px;
        padding: 12px;
        margin-bottom: 15px;
    }
</style>
{% endblock %}

{% block content %}
<div class="screenshot-form">
    <div class="info-box">
        <span class="icon">â„¹ï¸</span>
        æ­¤å·¥å…·æœƒæ ¹æ“šæ‚¨æä¾›çš„ UUIDï¼Œå¾è³‡æ–™åº«æŸ¥è©¢ AdUnit è³‡æ–™ä¸¦è‡ªå‹•å»ºæ§‹æˆªåœ–ç¶²å€ï¼Œç„¶å¾Œæˆªå–æ‰‹æ©Ÿç‰ˆæœ¬çš„è¢å¹•ç•«é¢ã€‚
    </div>
    
    <form action="{{ url_for('screenshot.create_screenshot') }}" method="post">
        <label for="uuid">è¼¸å…¥ UUIDï¼š</label>
        <input type="text" 
               id="uuid" 
               name="uuid" 
               class="uuid-input" 
               placeholder="ä¾‹å¦‚ï¼š84ab2622-dc2b-402d-b42b-b3ea54f9faeb" 
               required>
        
        <div style="margin-bottom: 15px;">
            <label for="device">é¸æ“‡è£ç½®é¡å‹ï¼š</label>
            <select id="device" name="device" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                <option value="iphone_x">iPhone X (375x812)</option>
                <option value="iphone_se">iPhone SE (375x667)</option>
                <option value="iphone_plus">iPhone Plus (414x736)</option>
                <option value="android">Android æ¨™æº– (360x640)</option>
                <option value="tablet">å¹³æ¿é›»è…¦ (768x1024)</option>
            </select>
        </div>
        
        <div style="margin-bottom: 15px;">
            <label>
                <input type="checkbox" name="full_page" value="true"> 
                å®Œæ•´é é¢æˆªåœ–ï¼ˆè€Œéåƒ…å¯è¦–å€åŸŸï¼‰
            </label>
        </div>
    
        <div style="margin-bottom: 15px;">
            <label for="scroll_distance">å‘ä¸‹æ»¾å‹•è·é›¢ï¼ˆåƒç´ ï¼‰ï¼š</label>
            <input type="number" 
                   id="scroll_distance" 
                   name="scroll_distance" 
                   value="4800" 
                   min="0" 
                   max="5000" 
                   step="50"
                   style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
        </div>
        
        <div style="margin-bottom: 15px;">
            <label for="wait_time">ç­‰å¾…æ™‚é–“ï¼ˆç§’ï¼‰ï¼š</label>
            <input type="number" 
                   id="wait_time" 
                   name="wait_time" 
                   value="3" 
                   min="1" 
                   max="30" 
                   style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
        </div>
        
        <button type="submit" class="screenshot-btn">é–‹å§‹æˆªåœ–</button>
    </form>
    
    {% if session.last_screenshot %}
    <div class="preview-container">
        <h3>æœ€æ–°æˆªåœ–çµæœ</h3>
        
        {% if session.last_screenshot_adunit_title %}
        <div class="adunit-info">
            <strong>AdUnit æ¨™é¡Œï¼š</strong>{{ session.last_screenshot_adunit_title }}<br>
            <strong>UUIDï¼š</strong>{{ session.last_screenshot_uuid }}
        </div>
        {% endif %}
        
        <div class="file-path">
            <strong>æª”æ¡ˆä½ç½®ï¼š</strong>{{ session.last_screenshot }}
        </div>
        
        {% set relative_path = session.last_screenshot.replace(config.get('UPLOAD_FOLDER', 'uploads'), '') %}
        {% if relative_path.startswith('/') %}
            {% set relative_path = relative_path[1:] %}
        {% endif %}
        
        {% if relative_path.endswith(('.png', '.jpg', '.jpeg', '.gif')) %}
        <img src="{{ url_for('screenshot.screenshot_base64', filename=relative_path) }}" 
             alt="æˆªåœ–é è¦½" 
             class="screenshot-preview"
             onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
        <div style="display: none; color: #999; margin-top: 10px;">
            ç„¡æ³•è¼‰å…¥åœ–ç‰‡é è¦½
        </div>
        {% endif %}
        
    </div>
    {% endif %}
</div>

<div class="help-section">
    <h3>ğŸ“‹ ä½¿ç”¨èªªæ˜</h3>
    <ul>
        <li><strong>UUID è¼¸å…¥ï¼š</strong>è¼¸å…¥ AdUnit çš„ UUIDï¼Œç³»çµ±æœƒè‡ªå‹•å¾è³‡æ–™åº«æŸ¥è©¢ç›¸é—œè³‡æ–™ä¸¦å»ºæ§‹æˆªåœ–ç¶²å€</li>
        <li><strong>è£ç½®é¸æ“‡ï¼š</strong>æ”¯æ´å¤šç¨®è£ç½®å°ºå¯¸ï¼ŒåŒ…æ‹¬ iPhone Xã€iPhone SEã€iPhone Plusã€Android æ¨™æº–å’Œå¹³æ¿é›»è…¦</li>
        <li><strong>æˆªåœ–æ¨¡å¼ï¼š</strong>å¯é¸æ“‡å¯è¦–å€åŸŸæˆªåœ–æˆ–å®Œæ•´é é¢æˆªåœ–</li>
        <li><strong>è‡ªå‹•ä½¿ç”¨ Cookieï¼š</strong>ç³»çµ±æœƒè‡ªå‹•ä½¿ç”¨ç™»å…¥ Cookieï¼Œé©ç”¨æ–¼éœ€è¦èªè­‰çš„é é¢</li>
        <li><strong>æ»¾å‹•åŠŸèƒ½ï¼š</strong>å¯è¨­å®šå‘ä¸‹æ»¾å‹•è·é›¢ï¼ˆ0-5000åƒç´ ï¼‰ï¼Œé è¨­æ»¾å‹•4800åƒç´ åˆ°å»£å‘Šå€åŸŸ</li>
        <li><strong>ç­‰å¾…æ™‚é–“ï¼š</strong>å¯è‡ªè¨‚é é¢è¼‰å…¥ç­‰å¾…æ™‚é–“ï¼ˆ1-30ç§’ï¼‰</li>
        <li><strong>ç€è¦½å™¨ï¼š</strong>ä½¿ç”¨ Chrome æ¨¡æ“¬æ‰‹æ©Ÿç€è¦½å™¨é€²è¡Œæˆªåœ–</li>
        <li><strong>å„²å­˜ä½ç½®ï¼š</strong>æˆªåœ–æœƒè‡ªå‹•å„²å­˜åœ¨ uploads/screenshots/ ç›®éŒ„ä¸‹</li>
        <li><strong>æª”æ¡ˆå‘½åï¼š</strong>æª”æ¡ˆåç¨±æ ¼å¼ç‚º screenshot_[è£ç½®]_[é¡å‹]_uuid-[UUID]_[æ»¾å‹•è·é›¢]_HHMMSS.png</li>
    </ul>
    
    <h3>âš ï¸ æ³¨æ„äº‹é …</h3>
    <ul>
        <li>è«‹ç¢ºä¿è¼¸å…¥çš„ UUID å­˜åœ¨æ–¼è³‡æ–™åº«ä¸­</li>
        <li>UUID æ ¼å¼æ‡‰ç‚ºæ¨™æº–çš„ GUID æ ¼å¼ï¼ˆå¦‚ï¼š84ab2622-dc2b-402d-b42b-b3ea54f9faebï¼‰</li>
        <li>æˆªåœ–å¯èƒ½éœ€è¦å¹¾ç§’é˜æ™‚é–“ï¼Œè«‹è€å¿ƒç­‰å¾…</li>
        <li>å®Œæ•´é é¢æˆªåœ–å¯èƒ½æœƒç”¢ç”Ÿè¼ƒå¤§çš„åœ–ç‰‡æª”æ¡ˆ</li>
        <li>ç­‰å¾…æ™‚é–“è¶Šé•·ï¼Œè¶Šèƒ½ç¢ºä¿å‹•æ…‹å…§å®¹å®Œå…¨è¼‰å…¥</li>
        <li>æ»¾å‹•å¾Œæœƒç­‰å¾… 1 ç§’è®“å…§å®¹ç©©å®šå†æˆªåœ–</li>
    </ul>
</div>
{% endblock %}

{% block additional_scripts %}
<script>
    // è¡¨å–®æäº¤æ™‚é¡¯ç¤ºè¼‰å…¥ç‹€æ…‹
    document.addEventListener('DOMContentLoaded', function() {
        const form = document.querySelector('form');
        const submitBtn = document.querySelector('.screenshot-btn');
        const originalText = submitBtn.textContent;
        
        form.addEventListener('submit', function() {
            submitBtn.textContent = 'æˆªåœ–ä¸­ï¼Œè«‹ç¨å€™...';
            submitBtn.disabled = true;
            submitBtn.style.backgroundColor = '#ccc';
        });
    });
</script>
{% endblock %} 