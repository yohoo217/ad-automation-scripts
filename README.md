# 廣告創建自動化工具

此專案提供一套自動化工具，用於建立和批量處理廣告，包含多種廣告類型，提高工作效率並減少人為錯誤。從原本的批量處理腳本改進為具有 Web 界面的應用程式。

## 功能特點

- Web 前端介面，易於使用
- 支援單個廣告建立和批量處理
- 支援多種廣告類型：
  - 原生廣告
  - 投票廣告
  - GIF 廣告
  - 水平 Slide 廣告
  - 垂直 Slide 廣告
  - 垂直 Cube Slide 廣告
  - 倒數廣告
- 圖片上傳功能，支援多種廣告尺寸 (1200x628, 300x300 等)
- 表單驗證和錯誤處理
- 詳細的操作日誌記錄

## 安裝及設定

### 前置需求

- Python 3.7+
- Playwright

### 安裝步驟

1. 安裝依賴套件：

```bash
pip install -r requirements.txt
```

2. 安裝 Playwright 瀏覽器驅動：

```bash
playwright install
```

3. 修改 `config.py` 以設定您的帳號密碼：

```python
EMAIL = "your_email@example.com"
PASSWORD = "your_password"
```

## 使用方法

1. 啟動 Web 應用程式：

```bash
python app.py
```

2. 在瀏覽器中訪問 http://localhost:5002

## 頁面說明

### 原生廣告頁面

用於創建標準原生廣告：
- 填寫基本資訊（廣告商、標題、Adset ID等）
- 上傳或指定不同尺寸的廣告圖片
- 表單可透過「快速資訊輸入」功能解析格式化的廣告資訊

### 投票廣告頁面

用於創建互動式投票廣告：
- 支援自定義投票選項（至少兩個）
- 可設定投票區塊的樣式、位置、顯示動畫等
- 支援贏/輸選項的顏色設定

### GIF 廣告頁面

用於創建動態 GIF 廣告：
- 上傳 GIF 素材
- 設定背景圖片和跳轉鏈接

### 滑動廣告頁面 (Slide Ad)

用於創建水平滑動廣告：
- 支援多個滑動項目（至少兩個）
- 每個項目可設定獨立的圖片和目標 URL

### 垂直滑動廣告頁面

用於創建垂直滑動廣告：
- 與水平滑動類似，但方向為垂直
- 支援多個垂直滑動項目

### 垂直 Cube 滑動廣告頁面

用於創建 3D 立方體效果的垂直滑動廣告：
- 特殊的 3D 轉場效果
- 支援多個滑動項目

### 倒數廣告頁面

用於創建具有倒數計時效果的廣告：
- 設定倒數時間和目標事件
- 可自定義倒數元素的樣式

### 批量廣告建立頁面

用於一次性建立多個原生廣告：
- 默認顯示多列廣告表單
- 可動態增減廣告行數
- 支援批量上傳圖片
- 表單提交前會進行驗證

## 配置選項

- 修改 `app.py` 中的 `app.secret_key` 以增強安全性：
  ```python
  app.secret_key = 'your_very_secret_key'  # 更換為安全的隨機字串
  ```
- 建議以 headless 模式啟動瀏覽器 (headless=True) 以提高穩定性
- 若需更改端口，調整 `app.py` 最後一行的 port 參數：
  ```python
  app.run(debug=True, port=5002)
  ```

## 常見問題與解決方案

### "Target page, context or browser has been closed" 錯誤

**解決方案**：
- 資源管理優化：
  - 調整了 Playwright 的資源清理順序：先頁面，再上下文，最後瀏覽器
  - 更改了 sync_playwright 的使用方式，從 with 語句改為手動管理生命週期
  - 增加了詳細的錯誤捕獲和處理，確保所有資源被正確關閉

- 啟動選項調整：
  - 使用 headless=True 運行瀏覽器
  - 添加了 --no-sandbox、--disable-dev-shm-usage 等啟動參數

- 超時處理：
  - 增加了超時參數，提高頁面載入和操作的容忍度
  - 減少了等待時間，避免長時間等待導致的超時

### 其他常見問題

- **圖片無法上傳**：確保上傳路徑有寫入權限，並檢查圖片格式
- **廣告創建失敗**：檢查日誌文件 logs/app.log 獲取詳細錯誤信息
- **表單驗證錯誤**：確保填寫了所有必填欄位，並使用正確的格式

## 版本歷史

### v3.0.0 (當前版本)
- 新增多種廣告類型支援：投票廣告、GIF廣告、滑動廣告、倒數廣告等
- 改進 Playwright 資源管理
- 增強錯誤處理和日誌記錄

### v2.0.0
- 新增 Web 介面
- 支援300x300方形圖片
- 改進圖片上傳流程
- 表單驗證和錯誤處理

### v1.0.0
- 基於Google Sheet的批量廣告處理腳本