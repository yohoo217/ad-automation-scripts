# ğŸ¯ å»£å‘Š Workflow MCP å·¥å…·ä½¿ç”¨æŒ‡å—

## æ¦‚è¿°

é€™å€‹ MCP å·¥å…·ç¢ºä¿æ¯æ¬¡å‰µå»ºæ–°çš„å»£å‘Šåˆ†é æ™‚ï¼Œéƒ½åš´æ ¼éµå¾ª `FINAL_RECOMMENDED_WORKFLOW.md` ä¸­å®šç¾©çš„æ¨™æº–åŒ–æµç¨‹ï¼Œå¯¦ç¾ **93% çš„é–‹ç™¼æ•ˆç‡æå‡**ï¼ˆå¾ 9 å°æ™‚ç¸®çŸ­åˆ° 40 åˆ†é˜ï¼‰ã€‚

## ğŸš€ å¿«é€Ÿé–‹å§‹

### 1. å®‰è£è¨­å®š

```bash
cd /Users/aotter/ad-automation-scripts
chmod +x scripts/mcp_tools/setup.sh
./scripts/mcp_tools/setup.sh
```

### 2. é‡å•Ÿ Cursor

å®‰è£å®Œæˆå¾Œï¼Œ**é‡å•Ÿ Cursor** ä»¥è¼‰å…¥æ–°çš„ MCP å·¥å…·ã€‚

### 3. é©—è­‰å®‰è£

åœ¨ Cursor ä¸­è¼¸å…¥ï¼šã€Œè«‹åˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„ MCP å·¥å…·ã€ï¼Œç¢ºèªçœ‹åˆ°ä»¥ä¸‹å·¥å…·ï¼š
- `enforce_ad_workflow`
- `get_workflow_requirements` 
- `validate_workflow_compliance`

## ğŸ“‹ æ¨™æº–åŒ– Workflow

### éšæ®µ 1ï¼šéœ€æ±‚æ”¶é›†ï¼ˆ5åˆ†é˜ï¼‰

èª¿ç”¨ `get_workflow_requirements` å·¥å…·æŸ¥çœ‹éœ€è¦æ”¶é›†çš„ä¸‰é …æ ¸å¿ƒè³‡è¨Šï¼š

1. **JSON æ¬„ä½å®šç¾©**
2. **Payload æ ¼å¼**
3. **Suprad åƒæ•¸**

### éšæ®µ 2ï¼šè‡ªå‹•ç”Ÿæˆï¼ˆ15åˆ†é˜ï¼‰

èª¿ç”¨ `enforce_ad_workflow` å·¥å…·ï¼Œè‡ªå‹•ç”Ÿæˆï¼š
- âœ… æ¨™æº–åŒ–è·¯ç”±ä»£ç¢¼
- âœ… HTML æ¨¡æ¿
- âœ… JSON çµæ§‹å®šç¾©
- âœ… é–‹ç™¼æª¢æŸ¥æ¸…å–®

### éšæ®µ 3ï¼šæ•´åˆéƒ¨ç½²ï¼ˆ20åˆ†é˜ï¼‰

æ ¹æ“šå·¥å…·è¼¸å‡ºçš„æŒ‡ç¤ºï¼Œå®Œæˆï¼š
- ğŸ”§ ä»£ç¢¼æ•´åˆ
- ğŸ¨ æ¨¡æ¿éƒ¨ç½²
- âœ… åŠŸèƒ½æ¸¬è©¦
- ğŸ“ æ–‡æª”æ›´æ–°

## ğŸ å¯¶ç®±å»£å‘Šç¯„ä¾‹

ä»¥ä¸‹æ˜¯å®Œæ•´çš„å¯¶ç®±å»£å‘Šå‰µå»ºæµç¨‹ç¤ºç¯„ï¼š

### æ­¥é©Ÿ 1ï¼šæ”¶é›†éœ€æ±‚

**æ‚¨éœ€è¦æä¾›çš„è³‡è¨Šï¼š**

1. **å»£å‘Šé¡å‹ï¼š** `treasure_box`
2. **JSON æ¬„ä½å®šç¾©ï¼š**
   ```json
   {
     "treasure_box_image": {
       "type": "string",
       "default": "",
       "required": true,
       "description": "å¯¶ç®±åœ–ç‰‡ URL"
     },
     "reward_image": {
       "type": "string", 
       "default": "",
       "required": true,
       "description": "çå“åœ–ç‰‡ URL"
     },
     "reward_text": {
       "type": "string",
       "default": "",
       "required": true,
       "description": "çå“æè¿°æ–‡å­—"
     },
     "animation_type": {
       "type": "string",
       "default": "flip",
       "required": false,
       "description": "é–‹å•Ÿå‹•ç•«é¡å‹ï¼ˆflip/fade/rotateï¼‰"
     },
     "display_duration": {
       "type": "number",
       "default": 3000,
       "required": false,
       "description": "çå“é¡¯ç¤ºæ™‚é–“ï¼ˆæ¯«ç§’ï¼‰"
     }
   }
   ```
3. **Payload æ ¼å¼ï¼š** `payload_game_widget`
4. **Suprad åƒæ•¸ï¼š** `treasure_box`

### æ­¥é©Ÿ 2ï¼šåŸ·è¡Œå·¥å…·

åœ¨ Cursor ä¸­è¼¸å…¥ï¼š

```
è«‹ä½¿ç”¨ enforce_ad_workflow å·¥å…·å»ºç«‹å¯¶ç®±å»£å‘Šåˆ†é ï¼Œåƒæ•¸å¦‚ä¸‹ï¼š

{
  "ad_type": "treasure_box",
  "json_fields": {
    "treasure_box_image": {
      "type": "string",
      "default": "",
      "required": true,
      "description": "å¯¶ç®±åœ–ç‰‡ URL"
    },
    "reward_image": {
      "type": "string", 
      "default": "",
      "required": true,
      "description": "çå“åœ–ç‰‡ URL"
    },
    "reward_text": {
      "type": "string",
      "default": "",
      "required": true,
      "description": "çå“æè¿°æ–‡å­—"
    },
    "animation_type": {
      "type": "string",
      "default": "flip",
      "required": false,
      "description": "é–‹å•Ÿå‹•ç•«é¡å‹"
    },
    "display_duration": {
      "type": "number",
      "default": 3000,
      "required": false,
      "description": "çå“é¡¯ç¤ºæ™‚é–“ï¼ˆæ¯«ç§’ï¼‰"
    }
  },
  "payload_format": "payload_game_widget",
  "suprad_params": "treasure_box",
  "description": "ç”¨æˆ¶é»æ“Šå¯¶ç®±é–‹å•Ÿå‹•ç•«ï¼Œé¡¯ç¤ºçå“å…§å®¹"
}
```

### æ­¥é©Ÿ 3ï¼šæ•´åˆä»£ç¢¼

å·¥å…·åŸ·è¡ŒæˆåŠŸå¾Œï¼Œæœƒç”¢ç”Ÿä»¥ä¸‹æª”æ¡ˆï¼š

```
generated/treasure_box/
â”œâ”€â”€ treasure_box_routes.py      # è·¯ç”±ä»£ç¢¼
â”œâ”€â”€ treasure_box_ad.html        # HTML æ¨¡æ¿
â”œâ”€â”€ treasure_box_json_structure.json  # JSON çµæ§‹
â””â”€â”€ treasure_box_checklist.json # é–‹ç™¼æª¢æŸ¥æ¸…å–®
```

**æ•´åˆæ­¥é©Ÿï¼š**

1. **æ•´åˆè·¯ç”±ï¼š** å°‡ `treasure_box_routes.py` çš„å…§å®¹è¤‡è£½åˆ° `app/routes/main.py`
2. **éƒ¨ç½²æ¨¡æ¿ï¼š** å°‡ `treasure_box_ad.html` ç§»å‹•åˆ° `templates/` ç›®éŒ„
3. **æ›´æ–°å°è¦½ï¼š** åœ¨ `templates/base.html` çš„å°è¦½åˆ—ä¸­æ·»åŠ å¯¶ç®±å»£å‘Šé€£çµ
4. **æ¸¬è©¦åŠŸèƒ½ï¼š** å•Ÿå‹•æ‡‰ç”¨ä¸¦æ¸¬è©¦ `/treasure-box-ad` è·¯ç”±

## ğŸ”§ å·¥å…·åƒè€ƒ

### enforce_ad_workflow

**ä¸»è¦å·¥å…·ï¼ŒåŸ·è¡Œå®Œæ•´çš„ workflow**

**å¿…è¦åƒæ•¸ï¼š**
- `ad_type` (string): å»£å‘Šé¡å‹åç¨±ï¼ˆå°å¯«ï¼Œåº•ç·šåˆ†éš”ï¼‰
- `json_fields` (object): è‡ªå®šç¾© JSON æ¬„ä½å®šç¾©
- `payload_format` (string): Payload æ ¼å¼ï¼ˆpayload_game_widget ç­‰ï¼‰
- `suprad_params` (string): Suprad åŸ·è¡Œåƒæ•¸

**å¯é¸åƒæ•¸ï¼š**
- `description` (string): å»£å‘Šæè¿°
- `project_root` (string): å°ˆæ¡ˆæ ¹ç›®éŒ„ï¼ˆé è¨­ï¼šç•¶å‰ç›®éŒ„ï¼‰

**æ”¯æ´çš„ Payload æ ¼å¼ï¼š**
- `payload_game_widget` - éŠæˆ²é¡å»£å‘Šï¼ˆæ¨è–¦ç”¨æ–¼å¯¶ç®±å»£å‘Šï¼‰
- `payload_vote_widget` - æŠ•ç¥¨é¡å»£å‘Š
- `payload_popup_json` - å½ˆè·³å¼å»£å‘Š
- `custom_payload` - è‡ªå®šç¾©æ ¼å¼

### get_workflow_requirements

**ç²å–éœ€æ±‚æ”¶é›†æ¨¡æ¿**

**åƒæ•¸ï¼š**
- `show_examples` (boolean): æ˜¯å¦é¡¯ç¤ºç¯„ä¾‹ï¼ˆé è¨­ï¼štrueï¼‰

### validate_workflow_compliance

**é©—è­‰ç¾æœ‰å»£å‘Šåˆ†é çš„åˆè¦æ€§**

**åƒæ•¸ï¼š**
- `ad_type` (string): è¦æª¢æŸ¥çš„å»£å‘Šé¡å‹
- `project_root` (string): å°ˆæ¡ˆæ ¹ç›®éŒ„

## ğŸ“Š æ•ˆç‡æå‡çµ±è¨ˆ

| é–‹ç™¼éšæ®µ | å‚³çµ±æ–¹å¼ | MCP Workflow | ç¯€çœæ™‚é–“ |
|---------|----------|-------------|----------|
| éœ€æ±‚åˆ†æ | 2å°æ™‚ | 5åˆ†é˜ | 95% â¬‡ï¸ |
| UI è¨­è¨ˆ | 1.5å°æ™‚ | 0åˆ†é˜ | 100% â¬‡ï¸ |
| ä»£ç¢¼ç·¨å¯« | 4å°æ™‚ | 15åˆ†é˜ | 94% â¬‡ï¸ |
| æ¸¬è©¦èª¿è©¦ | 1.5å°æ™‚ | 15åˆ†é˜ | 83% â¬‡ï¸ |
| æ–‡æª”æ›´æ–° | 30åˆ†é˜ | 5åˆ†é˜ | 83% â¬‡ï¸ |
| **ç¸½è¨ˆ** | **9.5å°æ™‚** | **40åˆ†é˜** | **93% â¬‡ï¸** |

## âœ… æ¨™æº–åŒ–ä¿è­‰

æ­¤å·¥å…·ç¢ºä¿ç”Ÿæˆçš„ä»£ç¢¼ç¬¦åˆä»¥ä¸‹æ¨™æº–ï¼š

### å‘½åè¦ç¯„
- è·¯ç”±ï¼š`/{ad_type}-ad`ã€`/create-{ad_type}-ad`ã€`/clear-{ad_type}-form`
- æ¨¡æ¿ï¼š`templates/{ad_type}_ad.html`
- Sessionï¼š`{ad_type}_form_data`

### æ¶æ§‹æ¨™æº–
- çµ±ä¸€çš„éŒ¯èª¤è™•ç†æ©Ÿåˆ¶
- æ¨™æº–çš„è¡¨å–®é©—è­‰é‚è¼¯
- ä¸€è‡´çš„ Session ç®¡ç†
- è¦ç¯„çš„ Suprad æ•´åˆ

### ä»£ç¢¼å“è³ª
- å®Œæ•´çš„è¨»è§£å’Œæ–‡æª”
- éŸ¿æ‡‰å¼ UI è¨­è¨ˆ
- å³æ™‚é è¦½åŠŸèƒ½
- å®Œå–„çš„ JavaScript äº¤äº’

## ğŸš¨ å¸¸è¦‹å•é¡Œ

### Q1: å·¥å…·å®‰è£å¾Œåœ¨ Cursor ä¸­çœ‹ä¸åˆ°ï¼Ÿ

**A:** ç¢ºä¿å·²ç¶“é‡å•Ÿ Cursorï¼Œä¸¦æª¢æŸ¥ `.cursor/mcp.json` é…ç½®æ˜¯å¦æ­£ç¢ºã€‚

### Q2: JSON æ¬„ä½é¡å‹æœ‰é™åˆ¶å—ï¼Ÿ

**A:** ç›®å‰æ”¯æ´ `string`ã€`number`ã€`boolean` ä¸‰ç¨®åŸºæœ¬é¡å‹ï¼Œè¶³ä»¥è¦†è“‹å¤§éƒ¨åˆ†ä½¿ç”¨å ´æ™¯ã€‚

### Q3: å¯ä»¥è‡ªå®šç¾© Payload æ ¼å¼å—ï¼Ÿ

**A:** å¯ä»¥é¸æ“‡ `custom_payload` ä¸¦åœ¨ç”Ÿæˆå¾Œæ‰‹å‹•èª¿æ•´ payload å»ºæ§‹é‚è¼¯ã€‚

### Q4: ç”Ÿæˆçš„ä»£ç¢¼å¯ä»¥ä¿®æ”¹å—ï¼Ÿ

**A:** å¯ä»¥ï¼Œä½†å»ºè­°å…ˆæ¸¬è©¦åŸºç¤åŠŸèƒ½ï¼Œå†æ ¹æ“šéœ€è¦é€²è¡Œå®¢è£½åŒ–ä¿®æ”¹ã€‚

### Q5: å¦‚ä½•æ·»åŠ æ–°çš„å»£å‘Šåˆ°å°è¦½åˆ—ï¼Ÿ

**A:** éœ€è¦æ‰‹å‹•åœ¨ `templates/base.html` ä¸­æ·»åŠ å°æ‡‰çš„å°è¦½é€£çµã€‚

## ğŸ¯ æœ€ä½³å¯¦è¸

1. **æ˜ç¢ºéœ€æ±‚ï¼š** åœ¨ä½¿ç”¨å·¥å…·å‰ï¼Œå…ˆæ¸…æ¥šå®šç¾©å»£å‘Šçš„æ ¸å¿ƒåŠŸèƒ½å’Œäº¤äº’æµç¨‹
2. **æ¨™æº–å„ªå…ˆï¼š** å„ªå…ˆä½¿ç”¨æ¨™æº– payload æ ¼å¼ï¼Œé¿å…ä¸å¿…è¦çš„å®¢è£½åŒ–
3. **æ¸¬è©¦é©…å‹•ï¼š** ç”Ÿæˆä»£ç¢¼å¾Œç«‹å³é€²è¡ŒåŠŸèƒ½æ¸¬è©¦
4. **æ–‡æª”åŒæ­¥ï¼š** åŠæ™‚æ›´æ–° README å’Œ FEATURE_SUMMARY æ–‡æª”
5. **ç‰ˆæœ¬æ§åˆ¶ï¼š** å°‡ç”Ÿæˆçš„ä»£ç¢¼æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ç³»çµ±

## ğŸš€ ä¸‹ä¸€æ­¥ç™¼å±•

è¨ˆåŠƒä¸­çš„åŠŸèƒ½å¢å¼·ï¼š

- [ ] æ”¯æ´æ›´å¤š payload æ ¼å¼
- [ ] è‡ªå‹•ç”Ÿæˆå–®å…ƒæ¸¬è©¦
- [ ] é›†æˆ CI/CD æµç¨‹
- [ ] æ•ˆèƒ½ç›£æ§å’Œåˆ†æ
- [ ] å¤šèªè¨€æ¨¡æ¿æ”¯æ´

---

**ğŸ‰ æ­å–œï¼æ‚¨å·²æŒæ¡äº†æœ€é«˜æ•ˆçš„å»£å‘Šåˆ†é é–‹ç™¼ workflowï¼**