{% extends "base.html" %}

{% block title %}åŸç”Ÿå»£å‘Šå»ºç«‹{% endblock %}

{% block page_title %}å»ºç«‹åŸç”Ÿå»£å‘Š{% endblock %}

{% block additional_styles %}
<style>
    .clear-form-btn {
        background-color: #f44336;
        color: white;
        padding: 10px 15px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        margin-bottom: 15px;
    }
    .clear-form-btn:hover {
        background-color: #d32f2f;
    }
</style>
{% endblock %}

{% block content %}
<button type="button" id="clear-form-button" class="clear-form-btn">æ¸…é™¤æ‰€æœ‰å…§å®¹</button>

    <form action="{{ url_for('native_ad.create_native_ad') }}" method="post" id="ad-form">
    <div class="field-group">
        <h3>ğŸ“‹ åŸºæœ¬å»£å‘Šè³‡è¨Š</h3>
        
        <div class="form-grid-2">
            <div class="form-row">
                <label for="adset_id">Adset ID <span class="required">*</span></label>
                <input type="text" id="adset_id" name="adset_id" value="{{ adset_id or '' }}" required
                       placeholder="ä¾‹å¦‚ï¼š00947c1b-f7cd-47c6-a23a-0639e9702cc7">
                <div class="help-text">å»£å‘Šçµ„IDï¼Œå¿…å¡«</div>
            </div>
            
            <div class="form-row">
                <label for="display_name">å»£å‘Šå–®å…ƒé¡¯ç¤ºåç¨±</label>
                <input type="text" id="display_name" name="display_name" value="{{ display_name or '' }}"
                       placeholder="åƒ…ä¾›å¾Œå°é¡¯ç¤ºä½¿ç”¨">
                <div class="help-text">åƒ…é¡¯ç¤ºæ–¼å¾Œå°ï¼Œå¯é¸</div>
            </div>
        </div>
        
        <div class="form-grid-2">
            <div class="form-row">
                <label for="advertiser">å»£å‘Šå•† <span class="required">*</span></label>
                <input type="text" id="advertiser" name="advertiser" value="{{ advertiser or '' }}" required
                       placeholder="å»£å‘Šä¸»åç¨±">
                <div class="help-text">å»£å‘Šä¸»åç¨±ï¼Œå¿…å¡«</div>
            </div>
            
            <div class="form-row">
                <label for="main_title">ä¸»æ¨™é¡Œ <span class="required">*</span></label>
                <input type="text" id="main_title" name="main_title" value="{{ main_title or '' }}" required
                       placeholder="å»£å‘Šä¸»æ¨™é¡Œ">
                <div class="help-text">å»£å‘Šä¸»æ¨™é¡Œï¼Œå¿…å¡«</div>
            </div>
        </div>
        
        <div class="form-grid-2">
            <div class="form-row">
                <label for="subtitle">æ–‡å­—æ•˜è¿°</label>
                <input type="text" id="subtitle" name="subtitle" value="{{ subtitle or '' }}"
                       placeholder="å»£å‘Šå‰¯æ¨™é¡Œï¼ˆå¯é¸ï¼‰">
                <div class="help-text">å»£å‘Šå‰¯æ¨™é¡Œï¼Œå¯é¸</div>
            </div>
            
            <div class="form-row">
                <label for="call_to_action">è¡Œå‹•å‘¼ç±²æŒ‰éˆ•æ–‡å­—</label>
                <input type="text" id="call_to_action" name="call_to_action" value="{{ call_to_action or 'ç­è§£è©³æƒ…' }}"
                       placeholder="ç­è§£è©³æƒ…">
                <div class="help-text">CTAæŒ‰éˆ•æ–‡å­—ï¼Œé è¨­ç‚ºã€Œç­è§£è©³æƒ…ã€</div>
            </div>
        </div>
        
        <div class="form-grid-2">
            <div class="form-row">
                <label for="landing_page">åˆ°é”é é¢ç¶²å€ <span class="required">*</span></label>
                <input type="url" id="landing_page" name="landing_page" placeholder="https://example.com" 
                       value="{{ landing_page or '' }}" required>
                <div class="help-text">ç”¨æˆ¶é»æ“Šå»£å‘Šå¾Œè·³è½‰çš„ç¶²å€ï¼Œå¿…å¡«</div>
            </div>
            
            <div class="form-row">
                <label for="tracking_url">è¿½è¹¤ URL</label>
                <input type="url" id="tracking_url" name="tracking_url" placeholder="https://tracker.example.com?id=123" 
                       value="{{ tracking_url or '' }}">
                <div class="help-text">ç”¨æ–¼è¿½è¹¤é»æ“Šçš„URLï¼Œå¯é¸</div>
            </div>
        </div>
    </div>

    <div class="field-group">
        <h3>å»£å‘Šåœ–ç‰‡ <span class="required">*</span></h3>
        <p>æ‰€æœ‰åœ–ç‰‡å‡ç‚ºå¿…å¡«ã€‚è«‹æä¾›æœ¬åœ°å®Œæ•´æª”æ¡ˆè·¯å¾‘ï¼Œæˆ–ä½¿ç”¨ä¸Šå‚³åŠŸèƒ½ã€‚</p>
        
        <div class="form-row">
            <label for="image_path_m">åœ–ç‰‡ 1200x628 <span class="required">*</span></label>
            <div class="file-upload-container">
                <input type="text" id="image_path_m" name="image_path_m" placeholder="/path/to/your/image_1200x628.jpg" value="{{ image_path_m or '' }}" required>
                <div class="help-text">å¤§å‹æ©«å¹…åœ–ç‰‡ï¼Œå°ºå¯¸1200x628åƒç´ </div>
                <div class="preview-container">
                    <label class="custom-file-upload">
                        ä¸Šå‚³åœ–ç‰‡
                        <input type="file" class="file-input" data-target="image_path_m" accept="image/*">
                    </label>
                    <img id="preview_m" class="upload-preview" style="display: none;">
                </div>
            </div>
        </div>
        
        <div class="form-row">
            <label for="image_path_p">åœ–ç‰‡ 336x280/300x250 <span class="required">*</span></label>
            <div class="file-upload-container">
                <input type="text" id="image_path_p" name="image_path_p" placeholder="/path/to/your/image_336x280.jpg" value="{{ image_path_p or '' }}" required>
                <div class="help-text">ä¸­å‹æ©«å¹…åœ–ç‰‡ï¼Œå°ºå¯¸336x280åƒç´ æˆ–300x250åƒç´ </div>
                <div class="preview-container">
                    <label class="custom-file-upload">
                        ä¸Šå‚³åœ–ç‰‡
                        <input type="file" class="file-input" data-target="image_path_p" accept="image/*">
                    </label>
                    <img id="preview_p" class="upload-preview" style="display: none;">
                </div>
            </div>
        </div>
        
        <div class="form-row">
            <label for="image_path_o">åœ–ç‰‡ 640x100 <span class="required">*</span></label>
            <div class="file-upload-container">
                <input type="text" id="image_path_o" name="image_path_o" placeholder="/path/to/your/image_640x100.jpg" value="{{ image_path_o or '' }}" required>
                <div class="help-text">çª„æ©«å¹…åœ–ç‰‡ï¼Œå°ºå¯¸640x100åƒç´ </div>
                <div class="preview-container">
                    <label class="custom-file-upload">
                        ä¸Šå‚³åœ–ç‰‡
                        <input type="file" class="file-input" data-target="image_path_o" accept="image/*">
                    </label>
                    <img id="preview_o" class="upload-preview" style="display: none;">
                </div>
            </div>
        </div>
        
        <div class="form-row">
            <label for="image_path_s">åœ–ç‰‡ 300x300 <span class="required">*</span></label>
            <div class="file-upload-container">
                <input type="text" id="image_path_s" name="image_path_s" placeholder="/path/to/your/image_300x300.jpg" value="{{ image_path_s or '' }}" required>
                <div class="help-text">æ–¹å½¢åœ–ç‰‡ï¼Œå°ºå¯¸300x300åƒç´ </div>
                <div class="preview-container">
                    <label class="custom-file-upload">
                        ä¸Šå‚³åœ–ç‰‡
                        <input type="file" class="file-input" data-target="image_path_s" accept="image/*">
                    </label>
                    <img id="preview_s" class="upload-preview" style="display: none;">
                </div>
            </div>
        </div>
    </div>
    
    <input type="submit" value="å»ºç«‹åŸç”Ÿå»£å‘Š">
</form>
{% endblock %}

{% block additional_scripts %}
<script>
    // æ·»åŠ æ¸…é™¤è¡¨å–®æŒ‰éˆ•çš„äº‹ä»¶ç›£è½å™¨
    document.addEventListener('DOMContentLoaded', function() {
        document.getElementById('clear-form-button').addEventListener('click', function() {
            if(confirm('ç¢ºå®šè¦æ¸…é™¤æ‰€æœ‰å¡«å¯«çš„å…§å®¹å—ï¼Ÿ')) {
                clearFormInputs();
            }
        });
    });
    
    // æ¸…é™¤è¡¨å–®æ‰€æœ‰è¼¸å…¥æ¬„ä½çš„å‡½æ•¸
    function clearFormInputs() {
        // æ¸…é™¤æ–‡æœ¬è¼¸å…¥ã€URLã€æ•¸å­—è¼¸å…¥
        document.querySelectorAll('input[type="text"], input[type="url"], input[type="number"]').forEach(input => {
            input.value = '';
        });
        
        // æ¸…é™¤é è¦½åœ–ç‰‡
        document.querySelectorAll('.upload-preview').forEach(img => {
            img.style.display = 'none';
            img.src = '';
        });
    }

    // åŸç”Ÿå»£å‘Šç‰¹æœ‰çš„ JavaScript å‡½æ•¸
    function parseInfoText(inputText) {
        // è§£æå»£å‘Šä¸»
        let advertiserMatch = inputText.match(/-å»£å‘Šä¸»ï¼š(.*?)($|\n)/);
        if (advertiserMatch && advertiserMatch[1]) {
            document.getElementById('advertiser').value = advertiserMatch[1].trim();
        }
        
        // è§£ææ¨™é¡Œ
        let titleMatch = inputText.match(/-\s*æ¨™é¡Œï¼š(.*?)($|\n)/);
        if (titleMatch && titleMatch[1]) {
            document.getElementById('main_title').value = titleMatch[1].trim();
        }
        
        // è§£æå°é€£
        let landingMatch = inputText.match(/å°é€£ï¼š(https?:\/\/[^\s]+)/);
        if (landingMatch && landingMatch[1]) {
            document.getElementById('landing_page').value = landingMatch[1].trim();
        }
        
        // è§£æ CTA
        let ctaMatch = inputText.match(/-\s*CTAï¼š(.*?)($|\n)/);
        if (ctaMatch && ctaMatch[1]) {
            document.getElementById('call_to_action').value = ctaMatch[1].trim();
        }
    }
</script>
{% endblock %} 